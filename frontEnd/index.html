<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Welcome</title>
</head>
<body>
  <h1>Make requests</h1>
  <div>
    <h2>Info</h2>
    <div>
      <button type="button" onclick="info()">Api information</button>
    </div>
    <h2>Words</h2>
    <h4>Create</h4>
    <div>
      <label for="create-userId">UserId</label>
      <input type="text" name="create-userId" id="create-userId">
      <label for="create-word">word</label>
      <input type="text" name="create-word" id="create-word">
      <label for="create-wordCategory">wordCategory</label>
      <input type="text" name="create-wordCategory" id="create-wordCategory">      
      <button type="button" onclick="createWord()">Send</button>
    </div>
    <h4>Read</h4>
    <div>
      <label for="read-userId">UserId</label>
      <input type="text" name="read-userId" id="read-userId">
      <label for="read-word">word</label>
      <input type="text" name="read-word" id="read-word">    
      <button type="button" onclick="readWord()">Send</button>
    </div>
    <h4>Read All</h4>
    <div>
      <label for="read-all-userId">UserId</label>
      <input type="text" name="read-all-userId" id="read-all-userId">      
      <button type="button" onclick="readAllWords()">Send</button>
    </div>
    <h4>Update</h4>
    <div>
      <label for="update-userId">UserId</label>
      <input type="text" name="update-userId" id="update-userId">
      <label for="update-word">word</label>
      <input type="text" name="update-word" id="update-word">
      <label for="update-wordCategory">wordCategory</label>
      <input type="text" name="update-wordCategory" id="update-wordCategory">      
      <button type="button" onclick="updateWord()">Send</button>
    </div>
    <h4>Delete</h4>
    <div>
      <label for="delete-userId">UserId</label>
      <input type="text" name="delete-userId" id="delete-userId">
      <label for="delete-word">word</label>
      <input type="text" name="delete-word" id="delete-word">    
      <button type="button" onclick="deleteWord()">Send</button
    </div>
  </div>
  <div>
    <h2>Category</h2>
    <h4>Create</h4>
    <h4>Read</h4>
    <h4>Read All</h4>
    <h4>Update</h4>
    <h4>Delete</h4>
  </div>
</body>
</html>
<script>
  const BASE_URL = ''

  async function info() {
    await invoke(BASE_URL+'/info', 'GET')
  }
  
  async function invoke(url, method, body = null) {    
    const header = new Headers()
    header.append('Content-Type', 'application/json; charset=utf-8')
    header.append('Accept', 'application/json')

    const options = {
      method: method,
      headers: header,      
      mode: 'cors',
      body: JSON.stringify(body)
    }

    if (body == null) {
      delete options.body
    }

    try {
      const response = await fetch(url, options)
      const result = await response.json()
      return renderResponse(JSON.stringify(result))
    } catch (error) {
      return renderResponse(error.message)
    }
  }

  async function renderResponse(message) {
    alert(message)
    location.reload()
  }
  
  async function createWord() {
    const userId = document.getElementById('create-userId').value
    const word = document.getElementById('create-word').value
    const wordCategory = document.getElementById('create-wordCategory').value

    await invoke(BASE_URL+`/words/${userId}`, 'POST', {word, wordCategory})
  }
  
  async function readWord() {
    const userId = document.getElementById('read-userId').value
    const word = document.getElementById('read-word').value    

    await invoke(BASE_URL+`/words/${userId}/${word}`, 'GET')
  }

  async function readAllWords() {
    const userId = document.getElementById('read-all-userId').value

    await invoke(BASE_URL+`/words/${userId}`, 'GET')
  }

  async function updateWord() {
    const userId = document.getElementById('update-userId').value
    const word = document.getElementById('update-word').value
    const wordCategory = document.getElementById('update-wordCategory').value

    await invoke(BASE_URL+`/words/${userId}`, 'PATCH', {word, wordCategory})
  }

  async function deleteWord() {
    const userId = document.getElementById('delete-userId').value
    const word = document.getElementById('delete-word').value    

    await invoke(BASE_URL+`/words/${userId}/${word}`, 'DELETE')    
  }
</script>